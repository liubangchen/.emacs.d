navigator navbar {
  hidereport 0
}

account cost "Project Cost" {
   account dev "Development"
   account doc "Documentation"
}
account rev "Payments"
 # The Profit&Loss analysis should be rev - cost accounts.
balance cost rev

textreport report "Plan" {
  formats html
  #formats csv
  header '== å…¨å±€ä»»åŠ¡è§†å›¾ =='
  center -8<-
  [#Plan ä»»åŠ¡ç”˜ç‰¹å›¾] | [#Dashboard ä»»åŠ¡é¢æ¿] | [#Resource èµ„æºè§†å›¾]
  ----
  === è®¡åˆ’åˆ—è¡¨ ===
  <[report id="plan"]>
  ----
  === è¿›åº¦é¢æ¿ ===
  <[report id="dashboard"]>
  ----
  === æŠ•å…¥èµ„æº ===
  <[report id="resourceGraph"]>
  ->8-
}

macro TaskTip [
tooltip istask() -8<-
'''å¼€å§‹æ—¥æœŸ: ''' <-query attribute='start'->
'''ç»“æŸæ—¥æœŸ: ''' <-query attribute='end'->
----
'''èµ„æºåˆ†é…:'''

<-query attribute='resources'->
----
'''å‰ç½®ä»»åŠ¡: '''

<-query attribute='precursors'->
----
'''åç»­ä»»åŠ¡: '''

<-query attribute='followers'->
->8-
]

macro AlertColor [
cellcolor plan.alert = 0 "#00D000" # green
cellcolor plan.alert = 1 "#D0D000" # yellow
cellcolor plan.alert = 2 "#D00000" # red
]

#macro PriorityCn [
#]

macro PriorityCn [
celltext plan.priority = 1 "ğŸ”´P0"
celltext plan.priority = 2 "ğŸŸ¡P1"
celltext plan.priority = 3 "ğŸŸ¢P2"
]

# A traditional Gantt chart with a project overview.
taskreport plan "" {
    #  headline "Project Plan"
    scenarios plan
    timeformat "%Y-%m-%d"
    timezone "Asia/Shanghai"
    columns
    bsi{title 'åºå·'},
    name{title 'ä»»åŠ¡é¡¹'} ,
    priority {title 'ä¼˜å…ˆçº§'  ${PriorityCn} width 60},
	start{title 'å¼€å§‹æ—¶é—´' width 90 } ,
	end{title 'ç»“æŸæ—¶é—´' width 90} ,
	effort{title 'å·¥ä½œé‡(å¤©)'} ,
    duration{title 'å¼€å‘æ—¶é—´(å¤©)'},
    note{title 'ç±»åˆ«'} ,
    responsible{title 'è´Ÿè´£äºº'} ,
	effortdone{title 'å·²å…³é—­(å¤©)'} ,
	effortleft{title 'å¼€æ”¾çª—å£(å¤©)'} ,
	complete{title 'è¿›åº¦'} ,
	status{title 'ä»»åŠ¡çŠ¶æ€'} ,
	resources{title 'ç ”å‘'}
    #	chart {${TaskTip} }
   loadunit days
   sorttasks tree
   hideresource @all
   caption 'å·¥ä½œé‡ä»¥æ¯äººæ¯å¤©è®¡ç®—'
}

taskreport dashboard "" {
  headline "ä»»åŠ¡çŠ¶æ€ (<-query attribute='now'->)"
  columns name { title 'åç§°' ${AlertColor} width 200},
  resources { title 'èµ„æº'
    width 200 ${AlertColor}
    listtype bullets
    listitem "<-query attribute='name'->"
    start ${projectstart} end ${projectend} },
    alerttrend { title 'å€¾å‘' ${AlertColor} width 50 },
    journal { title 'æ—¥å¿—' width 350 ${AlertColor} }
    journalmode status_up
    journalattributes headline, author, date, summary, details
    hidetask ~hasalert(0)
    sorttasks alert.down, plan.end.up
    period %{${now} - 1w} +1w
}

    # A graph showing resource allocation. It identifies whether each
    # resource is under- or over-allocated for.
resourcereport resourceGraph "" {
      headline "å¼€å‘èµ„æºè§†å›¾"
      timeformat "%Y-%m-%d"
      timezone "Asia/Shanghai"
      columns no{title 'åºå·'},
      name{title 'ä¼ä¸šå¾®ä¿¡'},
      email{title 'æ–¹å‘'},
	  effort{title 'å·¥ä½œé‡'},
	  weekly { width 900 }
      loadunit days
      hidetask ~(isleaf() & isleaf_())
      sorttasks plan.start.up
  }
